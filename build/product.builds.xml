<?xml version="1.0"?>
<project name="product.builds" basedir=".">

	<property file="build.properties" />
	<import file="product.names.xml" />
	<import file="build-checks.xml" as="checks"/>

    <target name="trigger.product.builds">
    	<foreach list="${product.names}" target="trigger.build.if.changed" param="product.name" />
    </target>

    <target name="trigger.build.if.changed" depends="git.check,trigger.build" />
    <target name="trigger.build" if="${product.changed}">
    	<echo message="triggering build of ${product.name}" />

    	<get ignoreerrors="true" dest="${java.io.tmpdir}/build.html" 
    		src="${build.base.url}/${product.name}/build?token=${product.name}"
    		username="${build.username}" password="${build.password}"
    	/>
    </target>

</project>
